(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7631d887"],{"12e6":function(e,t,a){"use strict";var r=a("233f"),s=a.n(r);s.a},"21ff":function(e,t,a){"use strict";var r=a("9ff3"),s=a.n(r);s.a},"233f":function(e,t,a){},"2fef":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"auth"}},[a("span",{staticClass:"current-tab-title"},[e._v(e._s(e.currentTabTitle))]),a(e.currentTab,{tag:"component",on:{login:e.updateLoginState,changeTab:e.changeTab}})],1)},s=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"loginData",attrs:{model:e.loginData,"label-position":"top","status-icon":"",rules:e.loginDataRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"学号/工号：",prop:"id"}},[a("el-input",{attrs:{placeholder:"请输入学号/工号",autocomplete:"off"},model:{value:e.loginData.id,callback:function(t){e.$set(e.loginData,"id",t)},expression:"loginData.id"}})],1),a("el-form-item",{attrs:{label:"密码：",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off"},model:{value:e.loginData.password,callback:function(t){e.$set(e.loginData,"password",t)},expression:"loginData.password"}})],1),a("el-form-item",{attrs:{label:"您是：",prop:"userType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.loginData.userType,callback:function(t){e.$set(e.loginData,"userType",t)},expression:"loginData.userType"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("span",{staticClass:"change-tab",on:{click:function(t){return e.$emit("changeTab","Register")}}},[e._v("还没有账号？马上注册")]),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.submiting},on:{click:function(t){return e.submitForm("loginData")}}},[e._v("立即登录")])],1)],1)},o=[],i={name:"login",data:function(){var e=function(e,t,a){""===t?a(new Error("请输入学号")):a()},t=function(e,t,a){""===t?a(new Error("请输入密码")):a()},a=function(e,t,a){""===t?a(new Error("请选择您的身份！")):a()};return{loginData:{id:"",password:"",userType:""},loginDataRules:{id:[{validator:e,trigger:"change"}],password:[{validator:t,trigger:"change"}],userType:[{validator:a,trigger:"change"}]},options:[{value:0,label:"学生"},{value:1,label:"教师"}],submiting:!1}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a;t.submiting=!0,a=0===t.loginData.userType?"/api/stuLogin":"/api/tchLogin",t.$http.post(a,{id:t.loginData.id,password:t.loginData.password,userType:t.loginData.userType}).then((function(e){1===e.data.code&&(t.$emit("login",t.$getLoginState()),t.$router.push({path:"/"})),0===e.data.code&&t.$message({showClose:!0,message:e.data.info,type:"warning"}),-1===e.data.code&&t.$message({showClose:!0,message:e.data.errMsg,type:"error"})})).catch((function(e){console.log(e)})).finally((function(){t.submiting=!1}))}))}}},l=i,u=(a("ff96"),a("2877")),c=Object(u["a"])(l,n,o,!1,null,"6f20aec2",null),g=c.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"registerData",attrs:{model:e.registerData,"label-position":"top","status-icon":"",rules:e.registerDataRules}},[a("el-form-item",{attrs:{label:"学号/工号：",prop:"id"}},[a("el-input",{attrs:{placeholder:"请输入学号/工号",autocomplete:"off"},model:{value:e.registerData.id,callback:function(t){e.$set(e.registerData,"id",t)},expression:"registerData.id"}})],1),a("el-form-item",{attrs:{label:"姓名：",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入姓名",autocomplete:"off"},model:{value:e.registerData.username,callback:function(t){e.$set(e.registerData,"username",t)},expression:"registerData.username"}})],1),a("el-form-item",{attrs:{label:"密码：",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off"},model:{value:e.registerData.password,callback:function(t){e.$set(e.registerData,"password",t)},expression:"registerData.password"}})],1),a("el-form-item",{attrs:{label:"您是：",prop:"userType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.registerData.userType,callback:function(t){e.$set(e.registerData,"userType",t)},expression:"registerData.userType"}},e._l(e.userTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"学院/系：",prop:"faculty"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.registerData.faculty,callback:function(t){e.$set(e.registerData,"faculty",t)},expression:"registerData.faculty"}},e._l(e.faculty,(function(e,t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),0===e.registerData.userType?a("div",[a("el-form-item",{attrs:{label:"年级：",prop:"grade"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.registerData.grade,callback:function(t){e.$set(e.registerData,"grade",t)},expression:"registerData.grade"}},e._l(e.gradeOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"专业：",prop:"major"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.registerData.major,callback:function(t){e.$set(e.registerData,"major",t)},expression:"registerData.major"}},e._l(e.faculty[e.registerData.faculty],(function(e,t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e.faculty[e.registerData.faculty]?a("el-form-item",{attrs:{label:"班别：",prop:"sclass"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.registerData.sclass,callback:function(t){e.$set(e.registerData,"sclass",t)},expression:"registerData.sclass"}},e._l(e.faculty[e.registerData.faculty][e.registerData.major],(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e()],1):e._e(),a("span",{staticClass:"change-tab",on:{click:function(t){return e.$emit("changeTab","Login")}}},[e._v("已有账号？马上登录")]),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.submiting},on:{click:function(t){return e.submitForm("registerData")}}},[e._v("注册并登录")])],1)],1)},f=[],d=a("bd86"),m={name:"register",data:function(){var e=function(e,t,a){""===t?a(new Error("请输入学号")):a()},t=function(e,t,a){""===t?a(new Error("请输入姓名")):a()},a=function(e,t,a){""===t?a(new Error("请输入密码")):t.length<6||t.length>16?a(new Error("密码应至少6个字符且不多于16个字符")):a()},r=function(e,t,a){""===t?a(new Error("请选择您的身份！")):a()},s=function(e,t,a){""===t?a(new Error("请选择所属院系！")):a()},n=function(e,t,a){""===t?a(new Error("请选择所属专业！")):a()},o=function(e,t,a){""===t?a(new Error("请选择所属年级！")):a()},i=function(e,t,a){""===t?a(new Error("请选择所属班别！")):a()};return{registerData:{id:"",username:"",password:"",userType:"",faculty:"",major:"",grade:"",sclass:""},registerDataRules:{id:[{validator:e,trigger:"change"}],username:[{validator:t,trigger:"change"}],password:[{validator:a,trigger:"change"}],userType:[{validator:r,trigger:"change"}],faculty:[{validator:s,trigger:"change"}],major:[{validator:n,trigger:"change"}],grade:[{validator:o,trigger:"change"}],sclass:[{validator:i,trigger:"change"}]},userTypeOptions:[{value:0,label:"学生"},{value:1,label:"教师"}],gradeOptions:[],faculty:Object(d["a"])({},"计算机工程学院",Object(d["a"])({},"网络工程",[1,2])),submiting:!1}},created:function(){for(var e=1;e<=5;e++){var t=new Date;t.getMonth()>8&&1===e?this.gradeOptions.push(t.getFullYear()):this.gradeOptions.push(t.getFullYear()-e)}},methods:{login:function(){var e,t=this;e=0===this.registerData.userType?"/api/stuLogin":"/api/tchLogin",this.$http.post(e,{id:this.registerData.id,password:this.registerData.password,userType:this.registerData.userType}).then((function(e){1===e.data.code&&(t.$emit("login",t.$getLoginState()),t.$router.push({path:"/"})),0===e.data.code&&t.$message({showClose:!0,message:e.data.info,type:"warning"}),-1===e.data.code&&t.$message({showClose:!0,message:e.data.errMsg,type:"error"})})).catch((function(e){console.log(e)}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a;t.submiting=!0,a=0===t.registerData.userType?"/api/stuRegister":"/api/tchRegister",t.$http.post(a,t.registerData).then((function(e){1===e.data.code&&t.login(),0===e.data.code&&t.$message({showClose:!0,message:e.data.info,type:"warning"}),-1===e.data.code&&t.$message({showClose:!0,message:e.data.errMsg,type:"error"})})).catch((function(e){console.log(e)})).finally((function(){t.submiting=!1}))}))}}},h=m,b=(a("12e6"),Object(u["a"])(h,p,f,!1,null,"d4569d9e",null)),v=b.exports,D={name:"auth",data:function(){return{currentTab:"Login"}},computed:{currentTabTitle:function(){return"Login"===this.currentTab?"登录":"注册"}},created:function(){},methods:{changeTab:function(e){this.currentTab=e},updateLoginState:function(e){this.$parent.$emit("login",e)}},components:{Login:g,Register:v}},y=D,w=(a("21ff"),Object(u["a"])(y,r,s,!1,null,"d6786e0e",null));t["default"]=w.exports},"9ff3":function(e,t,a){},c7b9:function(e,t,a){},ff96:function(e,t,a){"use strict";var r=a("c7b9"),s=a.n(r);s.a}}]);
//# sourceMappingURL=chunk-7631d887.463e515d.js.map