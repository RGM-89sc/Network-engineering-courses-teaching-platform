(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69ad4cdb"],{"11e9":function(t,e,r){var n=r("52a7"),o=r("4630"),a=r("6821"),i=r("6a99"),c=r("69a8"),s=r("c69a"),l=Object.getOwnPropertyDescriptor;e.f=r("9e1e")?l:function(t,e){if(t=a(t),e=i(e,!0),s)try{return l(t,e)}catch(r){}if(c(t,e))return o(!n.f.call(t,e),t[e])}},"1af6":function(t,e,r){var n=r("63b6");n(n.S,"Array",{isArray:r("9003")})},"20fd5":function(t,e,r){"use strict";var n=r("d9f6"),o=r("aebd");t.exports=function(t,e,r){e in t?n.f(t,e,o(0,r)):t[e]=r}},3702:function(t,e,r){var n=r("481b"),o=r("5168")("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||a[o]===t)}},"386d":function(t,e,r){"use strict";var n=r("cb7c"),o=r("83a1"),a=r("5f1b");r("214f")("search",1,(function(t,e,r,i){return[function(r){var n=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,n):new RegExp(r)[e](String(n))},function(t){var e=i(r,t,this);if(e.done)return e.value;var c=n(t),s=String(this),l=c.lastIndex;o(l,0)||(c.lastIndex=0);var u=a(c,s);return o(c.lastIndex,l)||(c.lastIndex=l),null===u?-1:u.index}]}))},"3b2b":function(t,e,r){var n=r("7726"),o=r("5dbc"),a=r("86cc").f,i=r("9093").f,c=r("aae3"),s=r("0bfb"),l=n.RegExp,u=l,f=l.prototype,p=/a/g,d=/a/g,h=new l(p)!==p;if(r("9e1e")&&(!h||r("79e5")((function(){return d[r("2b4c")("match")]=!1,l(p)!=p||l(d)==d||"/a/i"!=l(p,"i")})))){l=function(t,e){var r=this instanceof l,n=c(t),a=void 0===e;return!r&&n&&t.constructor===l&&a?t:o(h?new u(n&&!a?t.source:t,e):u((n=t instanceof l)?t.source:t,n&&a?s.call(t):e),r?this:f,l)};for(var g=function(t){t in l||a(l,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},b=i(u),v=0;b.length>v;)g(b[v++]);f.constructor=l,l.prototype=f,r("2aba")(n,"RegExp",l)}r("7a56")("RegExp")},"40c3":function(t,e,r){var n=r("6b4c"),o=r("5168")("toStringTag"),a="Arguments"==n(function(){return arguments}()),i=function(t,e){try{return t[e]}catch(r){}};t.exports=function(t){var e,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=i(e=Object(t),o))?r:a?n(e):"Object"==(c=n(e))&&"function"==typeof e.callee?"Arguments":c}},"4ee1":function(t,e,r){var n=r("5168")("iterator"),o=!1;try{var a=[7][n]();a["return"]=function(){o=!0},Array.from(a,(function(){throw 2}))}catch(i){}t.exports=function(t,e){if(!e&&!o)return!1;var r=!1;try{var a=[7],c=a[n]();c.next=function(){return{done:r=!0}},a[n]=function(){return c},t(a)}catch(i){}return r}},"549b":function(t,e,r){"use strict";var n=r("d864"),o=r("63b6"),a=r("241e"),i=r("b0dc"),c=r("3702"),s=r("b447"),l=r("20fd5"),u=r("7cd6");o(o.S+o.F*!r("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,r,o,f,p=a(t),d="function"==typeof this?this:Array,h=arguments.length,g=h>1?arguments[1]:void 0,b=void 0!==g,v=0,y=u(p);if(b&&(g=n(g,h>2?arguments[2]:void 0,2)),void 0==y||d==Array&&c(y))for(e=s(p.length),r=new d(e);e>v;v++)l(r,v,b?g(p[v],v):p[v]);else for(f=y.call(p),r=new d;!(o=f.next()).done;v++)l(r,v,b?i(f,g,[o.value,v],!0):o.value);return r.length=v,r}})},"54a1":function(t,e,r){r("6c1c"),r("1654"),t.exports=r("95d5")},"590f":function(t,e,r){},"5dbc":function(t,e,r){var n=r("d3f4"),o=r("8b97").set;t.exports=function(t,e,r){var a,i=e.constructor;return i!==r&&"function"==typeof i&&(a=i.prototype)!==r.prototype&&n(a)&&o&&o(t,a),t}},"64a4":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-row",{attrs:{type:"flex",justify:"space-between"}},[r("el-col",{attrs:{span:5}},[r("el-input",{attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search",size:"small"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),r("el-row",{staticClass:"resources-list",attrs:{type:"flex"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.resources}},[1===t.user.userType?r("el-table-column",{attrs:{prop:"filename"},scopedSlots:t._u([{key:"header",fn:function(e){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.uploadResource}},[r("i",{staticClass:"el-icon-upload el-icon--left"}),t._v("上传课件\n          ")])]}},{key:"default",fn:function(e){return[r("a",{staticClass:"download-link",attrs:{href:e.row.href,download:e.row.filename}},[t._v(t._s(e.row.filename))]),/\.pdf$/i.test(e.row.filename)?r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"small"},on:{click:function(r){return t.$router.push({name:"preview_courseware",params:{course_id:t.$route.params.course_id,filename:e.row.filename}})}}},[t._v("在线预览")]):t._e()]}}],null,!1,4112136905)}):r("el-table-column",{attrs:{prop:"filename",label:"下载"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("a",{staticClass:"download-link",attrs:{href:e.row.href,download:e.row.filename}},[t._v(t._s(e.row.filename))]),/\.pdf$/i.test(e.row.filename)?r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"small"},on:{click:function(r){return t.$router.push({name:"preview_courseware",params:{course_id:t.$route.params.course_id,filename:e.row.filename}})}}},[t._v("在线预览")]):t._e()]}}])}),r("el-table-column",{attrs:{prop:"date",label:"日期",align:"right",width:"180"}}),1===t.user.userType?r("el-table-column",{attrs:{label:"操作",align:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return t.delResource(e.row)}}},[t._v("删除")])]}}],null,!1,3875224312)}):t._e()],1)],1),r("el-row",{attrs:{type:"flex",justify:"center"}},[t.gotAllResources?t._e():r("span",{staticClass:"show-more",on:{click:t.showMore}},[t._v("显示更多")])]),1===t.user.userType?r("el-dialog",{attrs:{title:"上传课件",visible:t.uploadDialogVisible},on:{"update:visible":function(e){t.uploadDialogVisible=e}}},[r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-upload",{ref:"upload",attrs:{drag:"",multiple:"",action:t.$serverBaseUrl+"/api/uploadResources",data:{classify:t.uploadClassify,courseID:t.courseID},"with-credentials":!0,"on-remove":t.handleRemove,"on-error":t.handleError,"on-success":t.handleSuccess,"file-list":t.fileList,"auto-upload":!1}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[t._v("\n          将文件拖到此处，或\n          "),r("em",[t._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(t.uploadTip))])])],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.uploadDialogVisible=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary",loading:t.updating},on:{click:t.submitUpload}},[t._v("开始上传")])],1),r("el-dialog",{attrs:{width:"30%",title:"上传成功",visible:t.uploadSuccessDialogVisible,"before-close":t.beforeSuccessDialogClose,"append-to-body":""},on:{"update:visible":function(e){t.uploadSuccessDialogVisible=e}}},[r("span",[t._v(t._s(t.uploaded)+"个文件已成功上传")]),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.continueUpload}},[t._v("继续上传")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:"/emptyPage"})}}},[t._v("返回资源列表")])],1)])],1):t._e()],1)},o=[],a=r("75fc"),i=(r("a481"),r("386d"),r("3b2b"),r("915c")),c={name:"show_resources",data:function(){return{classify:"courseware",search:"",loading:!0,allResources:[],skip:0,limit:15,gotAllResources:!1,uploadDialogVisible:!1,uploadClassify:"courseware",fileList:[],updating:!1,uploaded:0,uploadSuccessDialogVisible:!1,courseID:""}},computed:{resources:function(){var t=this;return this.allResources.filter((function(e){return new RegExp(t.search,"i").test(e.filename)}))},uploadTip:function(){if("courseware"===this.classify)return"请选择.pdf文件进行上传，.ppt/.pptx无法在线预览"}},props:{user:{type:Object,default:{}}},created:function(){this.courseID=this.$route.params.course_id,this.getResources(this.classify)},methods:{encodeFilename:function(t){return t.replace(/\+/g,"%2B").replace(/ /g,"-").replace(/\//g,"%2F").replace(/\?/g,"%3F").replace(/#/g,"%23").replace(/&/g,"%26").replace(/=/g,"%3D")},decodeFilename:function(t){return t.replace(/%2B/g,"+").replace(/%2F/g,"/").replace(/%3F/g,"?").replace(/%23/g,"#").replace(/%26/g,"&").replace(/%3D/g,"=")},showMore:function(){this.skip+=this.limit,this.getResources(this.classify)},getResources:function(t){var e=this;this.loading=!0;var r=this.courseID;i["g"].getResources({classify:t,courseID:r,skip:this.skip,limit:this.limit}).then((function(t){if(1===t.data.code){var n,o=t.data.data.map((function(t){return{filename:e.decodeFilename(t.filename),date:e.dateFormat(t.created),classify:t.classify,href:"".concat(e.$serverBaseUrl,"/static/").concat(t.classify,"/").concat(r,"/").concat(t.filename)}}));(n=e.allResources).push.apply(n,Object(a["a"])(o)),o.length<e.limit&&(e.gotAllResources=!0)}})).catch((function(t){console.log(t)})).finally((function(){e.loading=!1}))},delResource:function(t){var e=this;this.$confirm("此操作将从服务器删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["g"].delResources({classify:t.classify,filename:t.filename,courseID:e.courseID}).then((function(r){1===r.data.code&&e.$alert("".concat(t.filename,"已删除"),"删除成功",{confirmButtonText:"确定",callback:function(t){e.$router.push({path:"/emptyPage"})}})})).catch((function(t){console.log(t)}))})).catch((function(){}))},uploadResource:function(){this.uploadDialogVisible=!0},clearFileList:function(){this.uploaded=0,this.fileList=[]},submitUpload:function(){this.$refs.upload.submit(),this.updating=!0},handleRemove:function(t,e){},handleError:function(t,e,r){},handleSuccess:function(t,e,r){var n=this;1===t.code&&(this.uploaded++,this.uploaded>=r.length&&(this.updating=!1,this.uploadSuccessDialogVisible=!0)),0===t.code&&(this.updating=!1,this.clearFileList(),this.$alert(t.info,"上传失败",{confirmButtonText:"确定",callback:function(t){n.$router.push({path:"/emptyPage"})}})),-1===t.code&&(this.updating=!1,this.clearFileList(),this.$alert("发生了错误导致上传失败","上传失败",{confirmButtonText:"确定"}),console.log(t.errMsg))},continueUpload:function(){this.clearFileList(),this.uploadSuccessDialogVisible=!1},beforeSuccessDialogClose:function(t){this.clearFileList(),t()},dateFormat:function(t){var e=new Date(t);return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}}},s=c,l=(r("c35b"),r("2877")),u=Object(l["a"])(s,n,o,!1,null,"79530c62",null);e["default"]=u.exports},"75fc":function(t,e,r){"use strict";var n=r("a745"),o=r.n(n);function a(t){if(o()(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}var i=r("774e"),c=r.n(i),s=r("c8bb"),l=r.n(s);function u(t){if(l()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return c()(t)}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p(t){return a(t)||u(t)||f()}r.d(e,"a",(function(){return p}))},"774e":function(t,e,r){t.exports=r("d2d5")},"7cd6":function(t,e,r){var n=r("40c3"),o=r("5168")("iterator"),a=r("481b");t.exports=r("584a").getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||a[n(t)]}},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"8b97":function(t,e,r){var n=r("d3f4"),o=r("cb7c"),a=function(t,e){if(o(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=r("9b43")(Function.call,r("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(o){e=!0}return function(t,r){return a(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:a}},9093:function(t,e,r){var n=r("ce10"),o=r("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},"95d5":function(t,e,r){var n=r("40c3"),o=r("5168")("iterator"),a=r("481b");t.exports=r("584a").isIterable=function(t){var e=Object(t);return void 0!==e[o]||"@@iterator"in e||a.hasOwnProperty(n(e))}},a745:function(t,e,r){t.exports=r("f410")},b0dc:function(t,e,r){var n=r("e4ae");t.exports=function(t,e,r,o){try{return o?e(n(r)[0],r[1]):e(r)}catch(i){var a=t["return"];throw void 0!==a&&n(a.call(t)),i}}},c35b:function(t,e,r){"use strict";var n=r("590f"),o=r.n(n);o.a},c8bb:function(t,e,r){t.exports=r("54a1")},d2d5:function(t,e,r){r("1654"),r("549b"),t.exports=r("584a").Array.from},f410:function(t,e,r){r("1af6"),t.exports=r("584a").Array.isArray}}]);
//# sourceMappingURL=chunk-69ad4cdb.dbcd791c.js.map