(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d8ef742"],{"096f":function(e,t,i){"use strict";var n=i("dd77"),s=i.n(n);s.a},"11e9":function(e,t,i){var n=i("52a7"),s=i("4630"),c=i("6821"),r=i("6a99"),o=i("69a8"),a=i("c69a"),l=Object.getOwnPropertyDescriptor;t.f=i("9e1e")?l:function(e,t){if(e=c(e),t=r(t,!0),a)try{return l(e,t)}catch(i){}if(o(e,t))return s(!n.f.call(e,t),e[t])}},"1eab":function(e,t,i){},"20fd":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._l(e.choiceQuestions,(function(t,n){return i("el-row",{key:t.id},[i("el-card",{staticClass:"question",attrs:{shadow:"hover"}},[i("el-row",{staticClass:"question-header"},[i("el-col",{staticClass:"question-index",attrs:{span:12}},[i("span",[e._v("第"+e._s(n+1)+"题")])]),i("el-col",{staticClass:"question-control",attrs:{span:12}},[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.delQuestion(t.id)}}},[e._v("删除")])],1)],1),i("el-input",{attrs:{placeholder:"请输入题干（必填）"},model:{value:t.problem,callback:function(i){e.$set(t,"problem",i)},expression:"choiceQuestion.problem"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",placeholder:"请选择题型"},slot:"prepend",model:{value:t.questionType,callback:function(i){e.$set(t,"questionType",i)},expression:"choiceQuestion.questionType"}},[i("el-option",{attrs:{label:"单选题",value:"Exclusive"}}),i("el-option",{attrs:{label:"多选题",value:"Multiple"}})],1)],1),i("MultipleChoice",{staticClass:"question-setting",attrs:{questionType:t.questionType,courseid:e.courseID,exerciseid:e.exerciseID,questionid:t.id},model:{value:t.detail,callback:function(i){e.$set(t,"detail",i)},expression:"choiceQuestion.detail"}})],1)],1)})),i("el-row",{staticClass:"control"},[i("el-button",{attrs:{plain:""},on:{click:e.addQuestion}},[e._v("添加题目")])],1),i("el-row",{staticClass:"add-exerise"},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{placeholder:"请输入作业名称（必填）"},model:{value:e.exerciseName,callback:function(t){e.exerciseName=t},expression:"exerciseName"}},[i("template",{slot:"prepend"},[e._v("作业名称：")])],2)],1),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[i("el-button",{attrs:{type:"primary"},on:{click:e.updateExercisePaper}},[e._v("更新作业")])],1)],1)],2)},s=[],c=(i("ac6a"),i("915c")),r=i("7d35"),o={data:function(){return{courseID:"",exerciseID:"",exerciseName:"",choiceQuestions:[],delImgs:[]}},props:{user:{type:Object,default:{}}},created:function(){var e=this;this.courseID=this.$route.params.course_id,this.exerciseID=this.$route.query.id,this.exerciseID?this.getExercisePaper():this.$alert("没有找到该作业！","错误",{confirmButtonText:"确定",type:"error"}).then((function(){e.$router.push({path:"/course/".concat(e.$route.params.course_id,"/exercise")})})).catch((function(){}))},methods:{checkQuestionsInfo:function(){function e(e){return e.some((function(e){return!e.content}))}function t(e){return e.some((function(e){return e.isAnswer}))}return!this.choiceQuestions.some((function(i){if(!i.problem)return!0;if(!i.detail.selections)return!0;var n=e(i.detail.selections),s=t(i.detail.selections);return!(!n&&s)}))},getExercisePaper:function(){var e=this;c["d"].getExercisePaper({courseID:this.courseID,exerciseID:this.exerciseID}).then((function(t){1===t.data.code&&(e.exerciseName=t.data.data.exerciseName,e.choiceQuestions=t.data.data.choiceQuestions),-1===t.data.code&&(console.log(t.data.errMsg),e.$alert("发生了错误导致获取数据失败","获取数据失败",{confirmButtonText:"确定"}).then((function(){e.$router.push({path:"/course/".concat(e.$route.params.course_id,"/exercise")})})))})).catch((function(t){console.log(t),e.$alert("发生了错误导致获取数据失败","获取数据失败",{confirmButtonText:"确定"}).then((function(){e.$router.push({path:"/course/".concat(e.$route.params.course_id,"/exercise")})}))}))},updateExercisePaper:function(){var e=this;this.$confirm("此操作将更新作业, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.checkQuestionsInfo()&&e.exerciseName?c["d"].updateExercisePaper({courseID:e.courseID,exerciseID:e.exerciseID,exerciseName:e.exerciseName,choiceQuestions:e.choiceQuestions,delImgs:e.delImgs}).then((function(t){1===t.data.code&&e.$router.push({path:"/course/".concat(e.$route.params.course_id,"/exercise")}),-1===t.data.code&&(e.$alert("发生了错误导致更新失败","更新失败",{confirmButtonText:"确定"}),console.log(t.data.errMsg))})).catch((function(e){console.log(e)})):e.$message({message:"请先把必填项填写完成再提交！",type:"warning"})})).catch((function(e){}))},getQuestionID:function(){var e=[];return this.choiceQuestions.forEach((function(t){e.push(t.id)})),0===e.length?0:Math.max.apply(Math,e)+1},delQuestion:function(e){if(1===this.choiceQuestions.length)return this.$alert("请至少保留1道题！","提示",{confirmButtonText:"确定"}),null;this.choiceQuestions=this.choiceQuestions.filter((function(t){return t.id!==e||(t.detail.imgs.length>0&&c["d"].delQuestionImgs({imgs:t.detail.imgs}).then((function(e){})).catch((function(e){})),!1)}))},addQuestion:function(){this.choiceQuestions.push({id:this.getQuestionID(),questionType:"Exclusive",problem:"",detail:{}})}},components:{MultipleChoice:r["a"]}},a=o,l=(i("096f"),i("2877")),u=Object(l["a"])(a,n,s,!1,null,"1210ae2a",null);t["default"]=u.exports},"5dbc":function(e,t,i){var n=i("d3f4"),s=i("8b97").set;e.exports=function(e,t,i){var c,r=t.constructor;return r!==i&&"function"==typeof r&&(c=r.prototype)!==i.prototype&&n(c)&&s&&s(e,c),e}},"72d7":function(e,t,i){"use strict";var n=i("1eab"),s=i.n(n);s.a},"7d35":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("span",{staticClass:"selections-title"},[e._v("选项：")]),e._l(e.practiceSelections,(function(t){return i("div",{key:t.id,staticClass:"selection",attrs:{shadow:"never"}},[i("el-input",{attrs:{placeholder:"请输入选项内容（必填）"},on:{blur:e.setPractice},model:{value:t.content,callback:function(i){e.$set(t,"content",i)},expression:"selection.content"}},[i("template",{slot:"prepend"},[e._v(e._s(t.id)+".")])],2)],1)})),i("el-row",{staticClass:"control"},[i("el-button",{attrs:{type:"primary"},on:{click:e.addSelection}},[e._v("添加选项")]),e.practiceSelections.length>2?i("el-button",{attrs:{type:"danger"},on:{click:e.delLastSelection}},[e._v("删除最后一项")]):e._e()],1),i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{staticClass:"answer-setting",attrs:{label:"正确答案："}},["Exclusive"===e.questionType?i("el-select",{attrs:{placeholder:"请选择（必填）"},on:{change:e.setPractice},model:{value:e.practiceAnswer,callback:function(t){e.practiceAnswer=t},expression:"practiceAnswer"}},e._l(e.practiceSelections,(function(e){return i("el-option",{key:e.id,attrs:{label:e.id,value:e.id}})})),1):e._e(),"Multiple"===e.questionType?i("el-select",{attrs:{placeholder:"请选择（必填）",multiple:""},on:{change:e.setPractice},model:{value:e.practiceAnswers,callback:function(t){e.practiceAnswers=t},expression:"practiceAnswers"}},e._l(e.practiceSelections,(function(e){return i("el-option",{key:e.id,attrs:{label:e.id,value:e.id}})})),1):e._e()],1),i("el-form-item",{staticClass:"analyze-setting",attrs:{label:"答案解析："}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},resize:"none",placeholder:"请输入答案解析（选填）"},on:{change:e.setPractice},model:{value:e.practiceAnalyze,callback:function(t){e.practiceAnalyze=t},expression:"practiceAnalyze"}})],1)],1),i("el-row",{staticClass:"upload-img"},[i("el-upload",{attrs:{action:e.$serverBaseUrl+"/api/uploadQuestionImg",data:{courseID:e.courseid,exerciseID:e.exerciseid,questionID:e.questionid},accept:".jpg, .png","with-credentials":!0,"before-upload":e.beforeImgUpload,"on-remove":e.removeImg,"on-success":e.imgUploadScuess,"file-list":e.uploadImgs,"list-type":"picture"}},[i("el-button",{attrs:{type:"primary"}},[e._v("上传配图")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n        只能上传jpg/png文件，且不超过500kb\n      ")])],1)],1)],2)},s=[],c=(i("7f7f"),i("ac6a"),i("c5f6"),i("915c")),r={data:function(){return{practiceSelections:[{id:"A",content:""},{id:"B",content:""}],practiceAnswer:"",practiceAnswers:[],practiceAnalyze:"",uploadImgs:[]}},watch:{questionType:function(e,t){this.setPractice()}},model:{prop:"detail",event:"setPractice"},props:{questionType:{type:String,default:"Exclusive"},detail:{type:Object,default:{}},courseid:{type:String,require:!0},exerciseid:{type:String,require:!0},questionid:{type:Number,require:!0}},created:function(){var e=this;if(this.practiceSelections=this.detail.selections||[{id:"A",content:""},{id:"B",content:""}],this.uploadImgs=this.detail.imgs||[],this.practiceAnalyze=this.detail.analyze,"Exclusive"===this.questionType&&this.detail.selections)this.detail.selections.some((function(t){return!!t.isAnswer&&(e.practiceAnswer=t.id,!0)}));else if("Multiple"===this.questionType&&this.detail.selections){var t=[];this.detail.selections.forEach((function(e){e.isAnswer&&t.push(e.id)})),this.practiceAnswers=t}},methods:{setPractice:function(){var e=this;"Exclusive"===this.questionType&&(this.practiceSelections=this.practiceSelections.map((function(t){return t.id===e.practiceAnswer?t.isAnswer=!0:t.isAnswer=!1,t}))),"Multiple"===this.questionType&&(this.practiceSelections=this.practiceSelections.map((function(t){return e.practiceAnswers.indexOf(t.id)>=0?t.isAnswer=!0:t.isAnswer=!1,t}))),this.$emit("setPractice",{selections:this.practiceSelections,analyze:this.practiceAnalyze,imgs:this.uploadImgs})},beforeImgUpload:function(e){var t=e.size<512e3;return t||this.$message.error("上传图片大小不能超过 500KB!"),t},removeImg:function(e,t){var i=this;if("success"!==e.status)return null;this.uploadImgs.push({}),this.uploadImgs.pop(),this.$confirm("此操作将删除图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c["d"].delQuestionImg({filename:e.name}).then((function(t){1===t.data.code&&(i.$message({type:"success",message:"删除成功!"}),i.uploadImgs=i.uploadImgs.filter((function(t){return t.name!==e.name})),i.setPractice()),-1===t.data.code&&(i.$alert("发生了错误导致删除失败","删除失败",{confirmButtonText:"确定"}),console.log(t.data.errMsg))})).catch((function(e){console.log(e)}))})).catch((function(e){}))},imgUploadScuess:function(e,t,i){1===e.code&&(this.uploadImgs.push({name:e.data.filename,url:e.data.url}),this.setPractice())},delLastSelection:function(){this.practiceAnswer="",this.practiceAnswers=[],this.practiceSelections.pop(),this.setPractice()},genLetters:function(){for(var e=[],t=65;t<91;t++)e.push(String.fromCharCode(t));return e},addSelection:function(){var e=this.genLetters();this.practiceSelections.push({id:e[this.practiceSelections.length],content:""})}}},o=r,a=(i("72d7"),i("2877")),l=Object(a["a"])(o,n,s,!1,null,"b339c8ac",null);t["a"]=l.exports},"7f7f":function(e,t,i){var n=i("86cc").f,s=Function.prototype,c=/^\s*function ([^ (]*)/,r="name";r in s||i("9e1e")&&n(s,r,{configurable:!0,get:function(){try{return(""+this).match(c)[1]}catch(e){return""}}})},"8b97":function(e,t,i){var n=i("d3f4"),s=i("cb7c"),c=function(e,t){if(s(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{n=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),n(e,[]),t=!(e instanceof Array)}catch(s){t=!0}return function(e,i){return c(e,i),t?e.__proto__=i:n(e,i),e}}({},!1):void 0),check:c}},9093:function(e,t,i){var n=i("ce10"),s=i("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,s)}},aa77:function(e,t,i){var n=i("5ca1"),s=i("be13"),c=i("79e5"),r=i("fdef"),o="["+r+"]",a="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),p=function(e,t,i){var s={},o=c((function(){return!!r[e]()||a[e]()!=a})),l=s[e]=o?t(d):r[e];i&&(s[i]=l),n(n.P+n.F*o,"String",s)},d=p.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=p},c5f6:function(e,t,i){"use strict";var n=i("7726"),s=i("69a8"),c=i("2d95"),r=i("5dbc"),o=i("6a99"),a=i("79e5"),l=i("9093").f,u=i("11e9").f,p=i("86cc").f,d=i("aa77").trim,f="Number",h=n[f],m=h,g=h.prototype,v=c(i("2aeb")(g))==f,x="trim"in String.prototype,y=function(e){var t=o(e,!1);if("string"==typeof t&&t.length>2){t=x?t.trim():d(t,3);var i,n,s,c=t.charCodeAt(0);if(43===c||45===c){if(i=t.charCodeAt(2),88===i||120===i)return NaN}else if(48===c){switch(t.charCodeAt(1)){case 66:case 98:n=2,s=49;break;case 79:case 111:n=8,s=55;break;default:return+t}for(var r,a=t.slice(2),l=0,u=a.length;l<u;l++)if(r=a.charCodeAt(l),r<48||r>s)return NaN;return parseInt(a,n)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof h&&(v?a((function(){g.valueOf.call(i)})):c(i)!=f)?r(new m(y(t)),i,h):y(t)};for(var I,b=i("9e1e")?l(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;b.length>_;_++)s(m,I=b[_])&&!s(h,I)&&p(h,I,u(m,I));h.prototype=g,g.constructor=h,i("2aba")(n,f,h)}},dd77:function(e,t,i){},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-5d8ef742.e7ffda30.js.map