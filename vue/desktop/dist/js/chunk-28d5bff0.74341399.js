(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28d5bff0"],{"11e9":function(e,t,n){var i=n("52a7"),s=n("4630"),r=n("6821"),o=n("6a99"),a=n("69a8"),c=n("c69a"),l=Object.getOwnPropertyDescriptor;t.f=n("9e1e")?l:function(e,t){if(e=r(e),t=o(t,!0),c)try{return l(e,t)}catch(n){}if(a(e,t))return s(!i.f.call(e,t),e[t])}},2366:function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);function s(e,t){var i=t||0,s=n;return[s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]]].join("")}e.exports=s},"33ef":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._l(e.choiceQuestions,(function(t,i){return n("el-row",{key:t.id},[n("el-card",{staticClass:"question",attrs:{shadow:"hover"}},[n("el-row",{staticClass:"question-header"},[n("el-col",{staticClass:"question-index",attrs:{span:12}},[n("span",[e._v("第"+e._s(i+1)+"题")])]),n("el-col",{staticClass:"question-control",attrs:{span:12}},[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.delQuestion(t.id)}}},[e._v("删除")])],1)],1),n("el-input",{attrs:{placeholder:"请输入题干（必填）"},model:{value:t.problem,callback:function(n){e.$set(t,"problem",n)},expression:"choiceQuestion.problem"}},[n("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",placeholder:"请选择题型"},slot:"prepend",model:{value:t.questionType,callback:function(n){e.$set(t,"questionType",n)},expression:"choiceQuestion.questionType"}},[n("el-option",{attrs:{label:"单选题",value:"Exclusive"}}),n("el-option",{attrs:{label:"多选题",value:"Multiple"}})],1)],1),n("ExamMultipleChoice",{staticClass:"question-setting",attrs:{questionType:t.questionType,courseid:e.courseID,exerciseid:e.examID,questionid:t.id},model:{value:t.detail,callback:function(n){e.$set(t,"detail",n)},expression:"choiceQuestion.detail"}})],1)],1)})),n("el-row",{staticClass:"control"},[n("el-button",{attrs:{plain:""},on:{click:e.addQuestion}},[e._v("添加题目")])],1),n("el-row",{staticClass:"add-exam"},[n("el-form",{attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"考试名称："}},[n("el-input",{attrs:{placeholder:"请输入考试名称（必填）"},model:{value:e.examName,callback:function(t){e.examName=t},expression:"examName"}})],1),n("el-form-item",{attrs:{label:"考试时长："}},[n("el-input-number",{attrs:{min:30,step:5},model:{value:e.examTiming,callback:function(t){e.examTiming=t},expression:"examTiming"}})],1),n("el-form-item",{attrs:{label:"考试有效期："}},[n("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.startEndTime,callback:function(t){e.startEndTime=t},expression:"startEndTime"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.addExamPaper}},[e._v("发布考试")])],1)],1)],1)],2)},s=[],r=(n("ac6a"),n("28a5"),n("915c")),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",{staticClass:"selections-title"},[e._v("选项：")]),e._l(e.practiceSelections,(function(t){return n("div",{key:t.id,staticClass:"selection",attrs:{shadow:"never"}},[n("el-input",{attrs:{placeholder:"请输入选项内容（必填）"},on:{blur:e.setPractice},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"selection.content"}},[n("template",{slot:"prepend"},[e._v(e._s(t.id)+".")])],2)],1)})),n("el-row",{staticClass:"control"},[n("el-button",{attrs:{type:"primary"},on:{click:e.addSelection}},[e._v("添加选项")]),e.practiceSelections.length>2?n("el-button",{attrs:{type:"danger"},on:{click:e.delLastSelection}},[e._v("删除最后一项")]):e._e()],1),n("el-form",{attrs:{"label-width":"100px"}},[n("el-form-item",{staticClass:"answer-setting",attrs:{label:"正确答案："}},["Exclusive"===e.questionType?n("el-select",{attrs:{placeholder:"请选择（必填）"},on:{change:e.setPractice},model:{value:e.practiceAnswer,callback:function(t){e.practiceAnswer=t},expression:"practiceAnswer"}},e._l(e.practiceSelections,(function(e){return n("el-option",{key:e.id,attrs:{label:e.id,value:e.id}})})),1):e._e(),"Multiple"===e.questionType?n("el-select",{attrs:{placeholder:"请选择（必填）",multiple:""},on:{change:e.setPractice},model:{value:e.practiceAnswers,callback:function(t){e.practiceAnswers=t},expression:"practiceAnswers"}},e._l(e.practiceSelections,(function(e){return n("el-option",{key:e.id,attrs:{label:e.id,value:e.id}})})),1):e._e()],1)],1),n("el-row",{staticClass:"upload-img"},[n("el-upload",{attrs:{action:e.$apiBaseUrl+"uploadExamQuestionImg",data:{courseID:e.courseid,exerciseID:e.exerciseid,questionID:e.questionid},accept:".jpg, .png","with-credentials":!0,"before-upload":e.beforeImgUpload,"on-remove":e.removeImg,"on-success":e.imgUploadScuess,"file-list":e.uploadImgs,"list-type":"picture"}},[n("el-button",{attrs:{type:"primary"}},[e._v("上传配图")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],2)},a=[],c=(n("7f7f"),n("c5f6"),{data:function(){return{practiceSelections:[{id:"A",content:""},{id:"B",content:""}],practiceAnswer:"",practiceAnswers:[],uploadImgs:[]}},watch:{questionType:function(e,t){this.setPractice()}},model:{prop:"detail",event:"setPractice"},props:{questionType:{type:String,default:"Exclusive"},detail:{type:Object,default:{}},courseid:{type:String,require:!0},exerciseid:{type:String,require:!0},questionid:{type:Number,require:!0}},created:function(){var e=this;if(this.practiceSelections=this.detail.selections||[{id:"A",content:""},{id:"B",content:""}],this.uploadImgs=this.detail.imgs||[],"Exclusive"===this.questionType&&this.detail.selections)this.detail.selections.some((function(t){return!!t.isAnswer&&(e.practiceAnswer=t.id,!0)}));else if("Multiple"===this.questionType&&this.detail.selections){var t=[];this.detail.selections.forEach((function(e){e.isAnswer&&t.push(e.id)})),this.practiceAnswers=t}},methods:{setPractice:function(){var e=this;"Exclusive"===this.questionType&&(this.practiceSelections=this.practiceSelections.map((function(t){return t.id===e.practiceAnswer?t.isAnswer=!0:t.isAnswer=!1,t}))),"Multiple"===this.questionType&&(this.practiceSelections=this.practiceSelections.map((function(t){return e.practiceAnswers.indexOf(t.id)>=0?t.isAnswer=!0:t.isAnswer=!1,t}))),this.$emit("setPractice",{selections:this.practiceSelections,imgs:this.uploadImgs})},beforeImgUpload:function(e){var t=e.size<512e3;return t||this.$message.error("上传图片大小不能超过 500KB!"),t},removeImg:function(e,t){var n=this;if("success"!==e.status)return null;this.uploadImgs.push({}),this.uploadImgs.pop(),this.$confirm("此操作将删除图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["c"].delQuestionImg({filename:e.name}).then((function(t){1===t.data.code&&(n.$message({type:"success",message:"删除成功!"}),n.uploadImgs=n.uploadImgs.filter((function(t){return t.name!==e.name})),n.setPractice()),-1===t.data.code&&(n.$alert("发生了错误导致删除失败","删除失败",{confirmButtonText:"确定"}),console.log(t.errMsg))})).catch((function(e){console.log(e)}))})).catch((function(e){}))},imgUploadScuess:function(e,t,n){1===e.code&&(this.uploadImgs.push({name:e.data.filename,url:e.data.url}),this.setPractice())},delLastSelection:function(){this.practiceAnswer="",this.practiceAnswers=[],this.practiceSelections.pop(),this.setPractice()},genLetters:function(){for(var e=[],t=65;t<91;t++)e.push(String.fromCharCode(t));return e},addSelection:function(){var e=this.genLetters();this.practiceSelections.push({id:e[this.practiceSelections.length],content:""})}}}),l=c,u=(n("f0a3"),n("2877")),p=Object(u["a"])(l,o,a,!1,null,"11de1571",null),f=p.exports,d=n("c64e"),m=n.n(d),h={data:function(){return{courseID:"",examID:"",examName:"",choiceQuestions:[{id:0,questionType:"Exclusive",problem:"",detail:{}}],startEndTime:[new Date,new Date],examTiming:60}},props:{user:{type:Object,default:{}}},created:function(){this.courseID=this.$route.params.course_id,this.examID=m()().split("-").join("")},methods:{checkQuestionsInfo:function(){function e(e){return e.some((function(e){return!e.content}))}function t(e){return e.some((function(e){return e.isAnswer}))}return!this.choiceQuestions.some((function(n){if(!n.problem)return!0;if(!n.detail.selections)return!0;var i=e(n.detail.selections),s=t(n.detail.selections);return!(!i&&s)}))},addExamPaper:function(){var e=this;this.$confirm("考试发布后无法修改, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(e.startEndTime[1]-e.startEndTime[0])/1e3/60<e.examTiming?e.$message({message:"考试有效期不能少于考试时长！",type:"error"}):e.checkQuestionsInfo()&&e.examName&&2===e.startEndTime.length&&e.examTiming?r["c"].addExamPaper({courseID:e.courseID,examID:e.examID,examName:e.examName,choiceQuestions:e.choiceQuestions,startTime:e.startEndTime[0],endTime:e.startEndTime[1],examTiming:e.examTiming}).then((function(t){1===t.data.code&&e.$router.push({path:"/course/".concat(e.courseID,"/exam")}),-1===t.data.code&&(e.$alert("发生了错误导致创建失败","创建失败",{confirmButtonText:"确定"}),console.log(t.data.errMsg))})).catch((function(e){console.log(e)})):e.$message({message:"请先把必填项填写完成再提交！",type:"warning"})})).catch((function(e){}))},getQuestionID:function(){var e=[];return this.choiceQuestions.forEach((function(t){e.push(t.id)})),0===e.length?0:Math.max.apply(Math,e)+1},delQuestion:function(e){if(1===this.choiceQuestions.length)return this.$alert("请至少保留1道题！","提示",{confirmButtonText:"确定"}),null;this.choiceQuestions=this.choiceQuestions.filter((function(t){return t.id!==e||(t.detail.imgs.length>0&&r["c"].delQuestionImgs({imgs:t.detail.imgs}).then((function(e){})).catch((function(e){})),!1)}))},addQuestion:function(){this.choiceQuestions.push({id:this.getQuestionID(),questionType:"Exclusive",problem:"",detail:{}})}},components:{ExamMultipleChoice:f}},g=h,v=(n("980a"),Object(u["a"])(g,i,s,!1,null,"76c15ebd",null));t["default"]=v.exports},"33fe":function(e,t,n){},"5dbc":function(e,t,n){var i=n("d3f4"),s=n("8b97").set;e.exports=function(e,t,n){var r,o=t.constructor;return o!==n&&"function"==typeof o&&(r=o.prototype)!==n.prototype&&i(r)&&s&&s(e,r),e}},"7f7f":function(e,t,n){var i=n("86cc").f,s=Function.prototype,r=/^\s*function ([^ (]*)/,o="name";o in s||n("9e1e")&&i(s,o,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},"8b97":function(e,t,n){var i=n("d3f4"),s=n("cb7c"),r=function(e,t){if(s(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(s){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},9093:function(e,t,n){var i=n("ce10"),s=n("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,s)}},"980a":function(e,t,n){"use strict";var i=n("33fe"),s=n.n(i);s.a},aa77:function(e,t,n){var i=n("5ca1"),s=n("be13"),r=n("79e5"),o=n("fdef"),a="["+o+"]",c="​",l=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),p=function(e,t,n){var s={},a=r((function(){return!!o[e]()||c[e]()!=c})),l=s[e]=a?t(f):o[e];n&&(s[n]=l),i(i.P+i.F*a,"String",s)},f=p.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=p},c5f6:function(e,t,n){"use strict";var i=n("7726"),s=n("69a8"),r=n("2d95"),o=n("5dbc"),a=n("6a99"),c=n("79e5"),l=n("9093").f,u=n("11e9").f,p=n("86cc").f,f=n("aa77").trim,d="Number",m=i[d],h=m,g=m.prototype,v=r(n("2aeb")(g))==d,y="trim"in String.prototype,x=function(e){var t=a(e,!1);if("string"==typeof t&&t.length>2){t=y?t.trim():f(t,3);var n,i,s,r=t.charCodeAt(0);if(43===r||45===r){if(n=t.charCodeAt(2),88===n||120===n)return NaN}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:i=2,s=49;break;case 79:case 111:i=8,s=55;break;default:return+t}for(var o,c=t.slice(2),l=0,u=c.length;l<u;l++)if(o=c.charCodeAt(l),o<48||o>s)return NaN;return parseInt(c,i)}}return+t};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof m&&(v?c((function(){g.valueOf.call(n)})):r(n)!=d)?o(new h(x(t)),n,m):x(t)};for(var b,w=n("9e1e")?l(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;w.length>I;I++)s(h,b=w[I])&&!s(m,b)&&p(m,b,u(h,b));m.prototype=g,g.constructor=m,n("2aba")(i,d,m)}},c64e:function(e,t,n){var i=n("e1f4"),s=n("2366");function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||s(o)}e.exports=r},cbf9:function(e,t,n){},e1f4:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},f0a3:function(e,t,n){"use strict";var i=n("cbf9"),s=n.n(i);s.a},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-28d5bff0.74341399.js.map