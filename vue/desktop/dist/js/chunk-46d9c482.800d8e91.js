(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46d9c482"],{"0944":function(t,e,a){},1751:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticClass:"header"},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"course-name"},[t._v(t._s(t.courseName))])]),t.user&&1===t.user.userType&&t.user.id===t.tchID?a("el-col",{staticClass:"toolsbar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:t.$route.path+"/addExamPaper"})}}},[t._v("发布考试")])],1):t._e()],1),0===t.examPapers.length?a("el-row",{staticClass:"no-exam-paper"},[a("span",[t._v("暂无考试")])]):t._e(),a("el-row",t._l(t.examPapers,(function(e){return a("el-card",{key:e.examID,staticClass:"exam-paper"},[a("el-row",[a("el-col",{attrs:{span:18}},[a("span",{staticClass:"exam-name",on:{click:function(a){return t.enterExam(e)}}},[t._v(t._s(e.examName))])]),t.user&&1===t.user.userType&&t.user.id===e.tchID?a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.openSetExamDialog(e)}}},[t._v("设置")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.delExamPaper(e.examID)}}},[t._v("删除")])],1):t._e()],1),a("el-row",[a("el-col",[a("span",{staticClass:"start-end-time"},[t._v("考试有效期："+t._s(t.$dayjs(e.startTime).format("YYYY/MM/DD HH:mm:ss"))+"\n            -\n            "+t._s(t.$dayjs(e.endTime).format("YYYY/MM/DD HH:mm:ss")))])])],1)],1)})),1),t.user&&1===t.user.userType?a("el-dialog",{attrs:{title:"设置考试",visible:t.settingExam,width:"40%"},on:{"update:visible":function(e){t.settingExam=e}}},[a("el-form",{attrs:{"label-width":"100px","label-position":"top"}},[a("el-form-item",{attrs:{label:"考试时长："}},[a("el-input-number",{attrs:{min:30,step:5},model:{value:t.currentSettingExam.examTiming,callback:function(e){t.$set(t.currentSettingExam,"examTiming",e)},expression:"currentSettingExam.examTiming"}})],1),a("el-form-item",{attrs:{label:"考试有效期："}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.currentSettingExam.startEndTime,callback:function(e){t.$set(t.currentSettingExam,"startEndTime",e)},expression:"currentSettingExam.startEndTime"}})],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.settingExam=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.updateExamPaper}},[t._v("确 定")])],1)],1):t._e()],1)},r=[],s=a("915c"),i={data:function(){return{courseID:"",courseName:"",examPapers:[],settingExam:!1,currentSettingExam:{examTiming:60,startEndTime:[]},tchID:""}},props:{user:{type:Object,default:{}}},created:function(){this.courseID=this.$route.params.course_id,this.courseName=window.sessionStorage.getItem("exams.current_coursename"),this.getTchID(),this.getExamPapers()},methods:{getTchID:function(){var t=this;s["b"].getCourseDetail({courseID:this.courseID}).then((function(e){1===e.data.code&&(t.tchID=e.data.data.tchID),-1===e.data.code&&console.log("获取课程对应的教师ID失败")})).catch((function(t){console.log(t)}))},getExamPapers:function(){var t=this;s["c"].getExamPapers({courseID:this.courseID}).then((function(e){1===e.data.code&&(t.examPapers=e.data.data)})).catch((function(t){console.log(t)}))},enterExam:function(t){var e=this,a=new Date;if(a<new Date(t.startTime)||a>new Date(t.endTime)-60*t.examTiming*1e3)return this.$alert("不在该考试有效期内！","无法进入考试",{confirmButtonText:"确定"}),null;!this.user||1!==this.user.userType&&0!==this.user.userType?this.$router.push({path:"/auth"}):s["c"].checkStuCanEnterExam({courseID:this.courseID,examID:t.examID}).then((function(a){if(1===a.data.code){if(!a.data.data.canEnterExam)return e.$alert(a.data.data.reason,"无法进入考试",{confirmButtonText:"确定"}),null;e.$router.push({path:"/course/".concat(e.courseID,"/exam/examPaper?id=").concat(t.examID,"&time=").concat(Date.now())})}-1===a.data.code&&(console.log(a.data.errMsg),e.$alert("发生了错误导致进入考试失败","进入考试失败",{confirmButtonText:"确定"}).then((function(){})))})).catch((function(t){console.log(t)}))},openSetExamDialog:function(t){this.$set(this.currentSettingExam,"examTiming",t.examTiming),this.$set(this.currentSettingExam,"startEndTime",[t.startTime,t.endTime]),this.$set(this.currentSettingExam,"examID",t.examID),this.settingExam=!0},updateExamPaper:function(){var t=this;(this.currentSettingExam.startEndTime[1]-this.currentSettingExam.startEndTime[0])/1e3/60<this.currentSettingExam.examTiming?this.$message({message:"考试有效期不能少于考试时长！",type:"error"}):s["c"].updateExamPaper({courseID:this.courseID,examID:this.currentSettingExam.examID,startTime:this.currentSettingExam.startEndTime[0],endTime:this.currentSettingExam.startEndTime[1],examTiming:this.currentSettingExam.examTiming}).then((function(e){1===e.data.code&&t.$router.push({path:"/emptyPage"}),-1===e.data.code&&(t.$alert("发生了错误导致操作失败","操作失败",{confirmButtonText:"确定"}),console.log(e.data.errMsg))})).catch((function(t){console.log(t)}))},delExamPaper:function(t){var e=this;this.$confirm("此操作将删除该考试, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["c"].delExamPaper({courseID:e.courseID,examID:t}).then((function(t){1===t.data.code&&e.$router.push({path:"/emptyPage"}),-1===t.data.code&&(e.$alert("发生了错误导致删除失败","删除失败",{confirmButtonText:"确定"}),console.log(t.data.errMsg))})).catch((function(t){console.log(t)}))})).catch((function(t){}))}}},o=i,c=(a("642e"),a("2877")),u=Object(c["a"])(o,n,r,!1,null,"24bd8bf8",null);e["default"]=u.exports},"642e":function(t,e,a){"use strict";var n=a("0944"),r=a.n(n);r.a}}]);
//# sourceMappingURL=chunk-46d9c482.800d8e91.js.map