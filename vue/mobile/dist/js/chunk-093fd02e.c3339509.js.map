{"version":3,"sources":["webpack:///./src/views/childrenViews/ArticleDetail.vue?aabc","webpack:///./src/views/childrenViews/ArticleDetail.vue?aca5","webpack:///./src/helpers/formatDate1.js","webpack:///./src/helpers/throttle.js","webpack:///src/views/childrenViews/ArticleDetail.vue","webpack:///./src/views/childrenViews/ArticleDetail.vue?d463","webpack:///./src/views/childrenViews/ArticleDetail.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","article","title","attrs","avatarURL","authorName","formatDate","created","dayjsNowTime","views","on","likesArticleHandler","likesLoading","isLiked","goodsCount","domProps","content","staticRenderFns","date","now","$dayjs","sss","diff","minute","Math","ceil","hour","day","format","throttle","timer","cb","delay","setTimeout","props","user","type","Object","default","data","articleType","$route","query","articleID","params","article_id","replyContent","currentReply","Date","methods","checkIdentity","$router","push","path","getArticle","incViewsCount","$http","post","console","error","err","handler","index","updateComments","ArticleProvider","updateArticle","res","code","updateReplys","starClickHandler","computed","component"],"mappings":"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","file":"js/chunk-093fd02e.c3339509.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleDetail.vue?vue&type=style&index=0&id=ded2b0bc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleDetail.vue?vue&type=style&index=0&id=ded2b0bc&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"article-detail\"},[_c('article',{staticClass:\"article-main\"},[_c('h1',{staticClass:\"article__title\"},[_vm._v(_vm._s(_vm.article.title))]),_c('div',{staticClass:\"article__meta sub-font_sub\"},[_c('p',{staticClass:\"article__author-avatar\"},[_c('img',{attrs:{\"src\":_vm.article.avatarURL,\"alt\":_vm.article.authorName}})]),_c('div',{staticClass:\"article__author-name-time\"},[_c('p',[_vm._v(_vm._s(_vm.article.authorName))]),_c('div',{staticClass:\"article__meta-detail\"},[_c('div',{staticClass:\"article__created item_padding\"},[_vm._v(\"\\n            \"+_vm._s(_vm.formatDate(_vm.article.created, _vm.dayjsNowTime))+\"\\n          \")]),_c('span',{staticClass:\"item_padding\"},[_vm._v(_vm._s(_vm.article.views)+\"次浏览   ·\")]),_c('span',{staticClass:\"article__good-btn item_padding\",on:{\"click\":_vm.likesArticleHandler}},[_c('md-icon',{attrs:{\"name\":_vm.likesLoading ? 'spinner' : 'arrow-up',\"color\":_vm.isLiked ? '#409eff' : 'gray',\"size\":\"md\"}}),_vm._v(\"\\n            \"+_vm._s(_vm.goodsCount)+\"次点赞\\n          \")],1)])])]),_c('div',{staticClass:\"article__content\",domProps:{\"innerHTML\":_vm._s(_vm.article.content)}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\n\r\nexport function formatDate (date, now, $dayjs) {\r\n  const created = $dayjs(date);\r\n  const sss = now.diff(created);\r\n  const minute = Math.ceil(sss / 1000 / 60);\r\n  const hour = Math.ceil(minute / 60);\r\n  const day = Math.ceil(hour / 24);\r\n  return minute > 59\r\n    ? hour > 23\r\n      ? day > 29\r\n        ? created.format('YYYY-MM-DD')\r\n        : `${day}天前`\r\n      : `${hour}小时前`\r\n    : `${minute}分钟前`;\r\n}","const throttle = (function(){\r\n  let timer = -1;\r\n  return (cb, delay = 1000)=>{\r\n    if(timer > 0){\r\n      return;\r\n    };\r\n    delay = timer === -1 ? 0 : delay;\r\n    timer = setTimeout(()=>{\r\n      cb();\r\n      timer = 0;\r\n    }, delay)\r\n  }\r\n})();\r\nexport {\r\n  throttle\r\n};","<template>\r\n  <div class=\"article-detail\">\r\n    <article class=\"article-main\">\r\n      <h1 class=\"article__title\">{{ article.title }}</h1>\r\n      <div class=\"article__meta sub-font_sub\" >\r\n        <p class=\"article__author-avatar\">\r\n          <img :src=\"article.avatarURL\" :alt=\"article.authorName\" />\r\n        </p>\r\n\r\n        <div class=\"article__author-name-time\">\r\n          <p>{{ article.authorName }}</p>\r\n\r\n          <div class=\"article__meta-detail\">\r\n            <div class=\"article__created item_padding\">\r\n              {{ formatDate(article.created, dayjsNowTime) }}\r\n            </div>\r\n            <span class=\"item_padding\"\r\n              >{{ article.views }}次浏览&nbsp;&nbsp;&nbsp;·</span\r\n            >\r\n            <span\r\n              class=\"article__good-btn item_padding\"\r\n              @click=\"likesArticleHandler\"\r\n            >\r\n              <md-icon :name=\"likesLoading ? 'spinner' : 'arrow-up'\" :color=\"isLiked ? '#409eff' : 'gray'\" size=\"md\"></md-icon>\r\n              {{ goodsCount }}次点赞\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"article__content\" v-html=\"article.content\"></div>\r\n    </article>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { formatDate } from '@/helpers/formatDate1';\r\nimport { throttle } from '@/helpers/throttle';\r\nexport default {\r\n  props: {\r\n    user: {\r\n      type: Object,\r\n      default: {}\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      article: {},\r\n      articleType: this.$route.query.articleType || 'news',\r\n      articleID: this.$route.params.article_id,\r\n      isLiked: false,\r\n      replyContent: '',\r\n      currentReply: '',\r\n      dayjsNowTime: this.$dayjs(Date.now()),\r\n      \r\n      goodsCount: 0,\r\n      likesLoading: false\r\n    };\r\n  },\r\n  methods: {\r\n    formatDate(date, now) {\r\n      return formatDate(date, now, this.$dayjs);\r\n    },\r\n    checkIdentity() {\r\n      if(!this.user.id){\r\n        this.$router.push({\r\n          path: '/auth'\r\n        });\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    getArticle() {\r\n     const url = '/api/getArticle';\r\n     this.$http.post(url,{\r\n        articleID: this.articleID,\r\n        articleType: this.articleType\r\n      })\r\n        .then(res => {\r\n          if (res.data.code === 1) {\r\n            this.article = res.data.data;\r\n            this.goodsCount = this.article.goods.length;\r\n            this.isLiked = this.article.isLiked;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n        });\r\n    },\r\n    incViewsCount(count = 1) {\r\n      this.$http.post('/api/incViewsCount',{\r\n        articleID: this.articleID,\r\n        articleType: this.articleType\r\n      })\r\n        .then((res) => {\r\n          this.article.views++;\r\n          console.log(res);\r\n        })\r\n        .catch(err => {\r\n          console.error(err); \r\n        });\r\n    },\r\n    likesArticleHandler() {\r\n      if(!this.checkIdentity()){\r\n        return false;\r\n      }\r\n      \r\n      this.likesLoading = true;\r\n      throttle(() => {\r\n        let likes = direction => {\r\n          const method = direction === 1 ? 'doLikes' : 'cancelLikes';\r\n          const api = `/api/${method}`;\r\n          this.$http.post(api, {\r\n          articleID: this.articleID,\r\n          articleType: this.articleType,\r\n          userID: this.user.id,\r\n          userType: this.user.userType,\r\n          userName: this.user.username\r\n        })\r\n        .then((res) => {\r\n            this.goodsCount += direction;\r\n          })\r\n        .catch(err => {\r\n            console.error(err);\r\n        })\r\n        .finally(_ => {\r\n          this.likesLoading = false;\r\n        });\r\n        }\r\n        !this.isLiked ? likes(1) : likes(-1);\r\n\r\n        this.isLiked = !this.isLiked;\r\n        })\r\n    },\r\n    handler(e) {\r\n      const index = e.currentTarget.dataset.index;\r\n      if (this.currentReply === index) {\r\n        return;\r\n      }\r\n      this.replyContent = '';\r\n      this.currentReply = index;\r\n    },\r\n    updateComments() {\r\n      ArticleProvider.updateArticle({\r\n        type: 'comment',\r\n        articleID: this.articleID\r\n      }).then(res => {\r\n        if (res.data.code === 1) {\r\n          this.$message({});\r\n        }\r\n      });\r\n    },\r\n    updateReplys() {},\r\n    starClickHandler() {}\r\n  },\r\n  computed: {},\r\n  created() {\r\n    this.getArticle();\r\n    this.incViewsCount();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.article-detail {\r\n  padding: 1rem;\r\n}\r\n.icon-left {\r\n  margin-right: 2px;\r\n}\r\n.display-info_sub {\r\n  font-size: 14px;\r\n  color: #909399 !important;\r\n}\r\n.display-info_normal {\r\n  font-size: 16px;\r\n  color: #000 !important;\r\n}\r\n.comment__item_wrapper {\r\n  border-bottom: 1px solid #eee;\r\n}\r\n.item_padding {\r\n  padding-right: 0.5rem;\r\n}\r\n.sub-font_sub {\r\n  font-size: 14px;\r\n  color: #999;\r\n}\r\n.article-main {\r\n  > .article__title {\r\n    font-size: 1.8rem;\r\n  }\r\n}\r\n.article__author-avatar {\r\n  img {\r\n    width: 2rem;\r\n    height: 2rem;\r\n    border-radius: 50%;\r\n  }\r\n  padding-right: 10px;\r\n}\r\n.article__author-name-time {\r\n  > p {\r\n    color: #409eff;\r\n  }\r\n  \r\n}\r\n.article__title {\r\n  padding-bottom: 0.5rem;\r\n  border-bottom:  1px solid #dcdfe6;\r\n}\r\n.article__meta {\r\n  display: flex;\r\n\r\n}\r\n.article__meta-detail {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.article__content {\r\n  margin-top: 2rem;\r\n  padding-top: 0.5rem;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleDetail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ArticleDetail.vue?vue&type=template&id=ded2b0bc&scoped=true&\"\nimport script from \"./ArticleDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./ArticleDetail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ArticleDetail.vue?vue&type=style&index=0&id=ded2b0bc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ded2b0bc\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}